addToTime(coalesce(item()?['Last'],'1900-01-01T00:00:00Z'), int(item()?['Months']), 'Month')

@and(
  greaterOrEquals(ticks(utcNow()), ticks(item()?['NextEligibleOn'])),
  greater(item()?['MatchesLeft'], 0)
)

{
  "Key": "@{guid()}",
  "P": "@{item()}"
}

formatDateTime(
  if(or(equals(item()?['Last'], null), equals(item()?['Last'], '')),
     utcNow(),
     addToTime(item()?['Last'], int(item()?['Months']), 'Month')
  ),
  'yyyy-MM-dd'
)
